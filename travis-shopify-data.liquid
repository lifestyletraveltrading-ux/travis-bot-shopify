<script>
  window.TravisData = {
    {% if customer %}
    customer: {
      id: {{ customer.id | json }},
      firstName: {{ customer.first_name | json }},
      lastName: {{ customer.last_name | json }},
      email: {{ customer.email | json }},
      ordersCount: {{ customer.orders_count | json }}
    },
    {% else %}
    customer: null,
    {% endif %}
    
    {% if cart %}
    cart: {
      itemCount: {{ cart.item_count | json }},
      totalPrice: {{ cart.total_price | money_without_currency | json }}
    },
    {% else %}
    cart: null,
    {% endif %}
    
    collections: [
      {% for collection in collections %}
      {
        id: {{ collection.id | json }},
        title: {{ collection.title | json }},
        handle: {{ collection.handle | json }},
        productsCount: {{ collection.products_count | json }}
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ],
    
    featuredProducts: [
      {% for product in collections.all.products limit: 10 %}
      {
        id: {{ product.id | json }},
        title: {{ product.title | json }},
        handle: {{ product.handle | json }},
        price: {{ product.price | money_without_currency | json }},
        comparePrice: {{ product.compare_at_price | money_without_currency | json }},
        type: {{ product.type | json }},
        tags: {{ product.tags | json }}
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ],
    
    // Add page context information
    pageContext: {
      type: {{ template | json }},
      {% if template == 'product' %}
      product: {
        id: {{ product.id | json }},
        title: {{ product.title | json }},
        handle: {{ product.handle | json }},
        type: {{ product.type | json }},
        price: {{ product.price | money_without_currency | json }},
        comparePrice: {{ product.compare_at_price | money_without_currency | json }},
        tags: {{ product.tags | json }}
      },
      {% endif %}
      {% if template == 'collection' %}
      collection: {
        id: {{ collection.id | json }},
        title: {{ collection.title | json }},
        handle: {{ collection.handle | json }},
        productsCount: {{ collection.products_count | json }}
      },
      {% endif %}
      {% if template == 'cart' %}
      cartPage: true,
      {% endif %}
      {% if template == 'search' %}
      searchPage: true,
      searchTerms: {{ search.terms | json }},
      resultsCount: {{ search.results_count | json }},
      {% endif %}
    }
  };
</script>
